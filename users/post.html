<!doctype html>
<html>

<head>
    <title>Пост</title>
    <link href="style.css" rel="stylesheet">
    <meta charset="utf-8">
</head>

<body>
    <script>
        window.addEventListener('DOMContentLoaded', load);

        let searchParams = new URLSearchParams(window.location.search);
        let i = String(searchParams);
        let id = i.slice(0, 2);

        function create_heading() {
            let heading = document.createElement("div");
            document.body.appendChild(heading);
            heading.appendChild(document.createTextNode("Мой блог"));
            heading.className = "text";

        }
        create_heading();

        function load() {

            fetch("post.php")
                .then(response => response.json())
                .then(result => {

                    let post = result;

                    let form = document.createElement("form");
                    document.body.appendChild(form);
                    form.className = "content";

                    let title1 = document.createElement("div");
                    document.body.appendChild(title1);
                    let text = document.createTextNode(post.title);
                    title1.appendChild(text);
                    title1.className = "title";

                    let content1 = document.createElement("div");
                    document.body.appendChild(content1);
                    text = document.createTextNode(post.content);
                    content1.appendChild(text);
                    content1.className = "content";

                    let date1 = document.createElement("div");
                    document.body.appendChild(date1);
                    text = document.createTextNode(post.date);
                    date1.appendChild(text);
                    date1.className = "data";

                    let button = document.createElement("button");
                    document.body.appendChild(button);
                    button.className = "button";
                    let text1 = document.createTextNode("Удалить");
                    button.appendChild(text1);
                    button.id = "delete_post";
                    button.onclick = delete_post;

                    function delete_post(event) {
                        let data = new FormData();
                        data.append("delete_post", 1);
                        fetch("post.php", { method: "post", body: data })
                            .then(response => response.text())
                            .then(result => {
                                window.location.href = "posts.html";
                            })
                    }
                
                })

        }

        function create_link() {
            let word = document.createElement("a");
            document.body.appendChild(word);
            let linkText = document.createTextNode("Изменить");
            word.appendChild(linkText);
            //word.title = "Изменить";
            word.href = 'change.html?' + id;

        }
        create_link();


    </script>
    <!--<div class="text"> Мой блог
</div>
<div class="content">
    <?php
        print_r('<div class="title">' . $note["title"] . '</div>');
        print_r($note["content"]);
        print_r('<div class="data">' . $note["date"] . '</div>');
    ?>
</div>
<div class="data">
    <a href="change.php?i=<?php echo $i; ?>&name_id=<?php echo $name_id; ?>">Изменить</a>
    <form method="post">
        <input type="submit" name="delete_post" value="Удалить">
    </form>
</div>-->
</body>

</html>